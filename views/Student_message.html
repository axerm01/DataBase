<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messaggi Studente</title>
    <link rel="shortcut icon" href="image/Seal_Bologna.svg.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Stile per link freccia indietro pagina precedente */
        .indietro {
            /* Posizionare l'elemento in basso a destra nell'header */
            position: absolute;
            bottom: 5px;
            right: 50px;
            /* Ridimensiona l'immagine contenuta in .indietro a 15x15 pixel */
            width: 20px;
            height: 20px;
        }

        .indietro a {
            /* Assicurati che l'ancora non abbia margini o padding per evitare spazi extra */
            display: block;
            margin: 0;
            padding: 0;
            /* Ridimensiona il link alla grandezza dell'immagine per evitare aree cliccabili non desiderate */
            width: 100%;
            height: 100%;
        }

        .indietro img {
            /* Forza l'immagine a estendersi completamente all'interno del suo contenitore */
            width: 100%;
            height: 100%;
            display: block;
            /* Rimuove lo spazio extra sotto l'immagine che potrebbe apparire */
        }

        .testo-indietro {
            position: absolute;
            /* Posizionare il testo in basso sotto l'immagine */
            bottom: 0;
            /* o il valore desiderato per la spaziatura dal fondo */
            right: 0;
            /* per allineare con l'immagine sopra */
            /* Stile opzionale per il testo */
            color: #ffffff;
            /* o qualsiasi colore desideri */
            font-size: 5px;
            /* o qualsiasi dimensione desideri */
        }

        .attributes_student_message {
            width: 78%;
            margin-right: auto;
            /* Spingi il contenitore verso sinistra */
            margin-left: auto;
            /* Spingi il contenitore verso destra */
            background-color: #fff;
            border: 2px solid #ccc;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            /* Centra gli elementi interni e crea spazio tra di essi */
        }

        .attributes_student_message h4 {
            flex: 1;
            /* Fai in modo che i paragrafi occupino spazi uguali all'interno del contenitore */
            text-align: center;
            /* Centra il testo all'interno dei paragrafi */
        }

        .button_student_message {
            flex-grow: 0;
            width: 79%;
            display: flex;
            float: right;
            flex-direction: row;
            /* Modifica da column a row */
            justify-content: flex-end;
            /* Aggiunto per centrare i bottoni orizzontalmente */
            flex-wrap: nowrap;
            /* Aggiunto per permettere ai bottoni di andare a capo se non c'è abbastanza spazio */
        }

        .Test_List {
            width: 83%;
            display: flex;
            margin-right: 265px;
            margin-left: 265px;
            background-color: #fff;
            border: 2px solid #ccc;
            border-radius: 5px;
        }

        .messages {
            width: 83%;
            display: flex;
            margin-right: 265px;
            margin-left: 265px;
            border-radius: 5px;
        }

        .square {
            width: 50%;
            /* Larghezza del quadrato */
            height: 300px;
            /* Altezza del quadrato */
            background-color: white;
            /* Colore di sfondo bianco */
            border: 2px solid black;
            /* Bordo nero di 2 pixel */
            margin-right: 30px;
            margin-left: 30px;
            border-radius: 5px;
            /* Bordo arrotondato */
            display: inline-block;
            /* Utilizziamo flex per centrare il testo verticalmente */
        }

        .square textarea {
            width: 90%;
            /* Larghezza del textarea rispetto al quadrato */
            height: 90%;
            /* Altezza del textarea rispetto al quadrato */
            padding: 10px;
            /* Spaziatura interna per una migliore leggibilità */
            resize: none;
            /* Disabilita il ridimensionamento del textarea */
            border: none;
            /* Rimuove il bordo predefinito del textarea */
            outline: none;
            /* Rimuove l'outline del textarea */
            font-size: inherit;
            /* Utilizza la dimensione del carattere ereditata dal genitore */
        }
    </style>
</head>

<body>
    <header>
        <h1>Studia con ESQL</h1>
        <div class="indietro">
            <!-- Usa "javascript:history.back()" come href per tornare indietro -->
            <a href="javascript:history.back()">
                <img src="image/arrow.png" alt="Torna indietro" style="width: 15px; height: 15px;">
            </a>
            <span class="testo-indietro">Indietro</span>
        </div>
    </header>

    <div class="message_container">
        <h2>MESSAGGI</h2>
    </div>

    <div class="attributes_student_message">
        <h4>Titolo Test</h4>
        <h4>Scrivi il Messaggio</h4>
    </div>
    <div class="messages">
        <div class="square">
            <p>messaggi</p>
        </div>
        <div class="square">
            <textarea id="messaggio" name="messaggio" placeholder="Scrivi qui il tuo messaggio..."></textarea>
        </div>
    </div>
    <div class="button_student_message">
        <button onclick="submitForm()">Invia</button>
    </div>


    <script>
        function submitForm() {
            var titolo = "prova"; // Recupera il valore del titolo dal campo di input
            var testo = "CIAIIAIAIA"; // Recupera il valore del testo dal campo di input
            var testId = 1; // Imposta l'ID del test associato al messaggio (qui lo sto impostando arbitrariamente a 1, dovresti ottenere l'ID dal tuo codice)
            var dataOra = new Date().toISOString(); // Ottiene la data e ora correnti nel formato ISO
            var studenteEmail = "davide@studio.unibo.it"; // Imposta l'email dello studente che invia il messaggio (qui lo sto impostando arbitrariamente a "studente@example.com", dovresti ottenerlo dal tuo codice)

            var formData = {
                title: titolo,
                text: testo,
                testId: testId,
                dateTime: dataOra,
                studentEmail: studenteEmail
            };
            $.ajax({
                type: 'POST',
                url:'../../DataBase-main/models/Message.php',
                contentType: 'application/json', // Imposta il tipo di contenuto come JSON
                data: JSON.stringify(formData), // Converte i dati del form in stringa JSON
                success: function (response) {
                    console.log(response); // Gestisci la risposta qui
                },
                error: function (xhr, status, error) {
                    console.error('Errore:', error);
                },
                dataType: 'json' // Aspettati una risposta JSON
            });
        }
    </script>
    <footer>
        <p>Alma Mater Studiorum</p>
        <h3>Università di Bologna</h3>
    </footer>
</body>

</html>