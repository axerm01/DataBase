<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Test - ESQL -</title>
    <link rel="shortcut icon" href="image/Seal_Bologna.svg.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Styles for questions */
        .question {
            margin-top: 20px;
            border: 1px solid #ccc; /* Add border around the question */
            border-radius: 5px; /* Add rounded corners for the question box */
            padding: 15px; /* Add padding inside the question box */
            background-color: #f9f9f9; /* Set background color for the question box */
            margin-right: 10px;
        }
        /* Styles for question input */
        .question-input {
            width: 30%; /* Make the input field occupy the full width of its container */
            padding: 10px; /* Add padding for better visual appeal */
            margin-top: 15px; /* Add some spacing below the input */
            border: 1px solid #ccc; /* Add a border for clarity */
            border-radius: 5px; /* Add rounded corners for a softer look */
            box-sizing: border-box; /* Include padding and border in the width calculation */
            font-size: 16px; /* Increase font size for better readability */
            background-color: #f9f9f9; /* Add a light background color */
            color: #333; /* Set text color */
        }
        .question input[type="text"] {
            width: 70%;
        }

        /* Styles for answers */
        .answer {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        /* Styles for answer input */
        .answer input[type="text"] {
            flex: 1;
            margin-right: 10px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        /* Styles for answer checkbox */
        .answer input[type="checkbox"] {
            margin-right: 5px;
            transform: scale(1.5); 
            margin-left: 10px;
        }

        /* Styles for add answer button */
        .add-answer-button {
            background-color: #007bff;
            cursor: pointer;
            font-size: 12px;
        }
        /*Styles for check botton*/
        .add-check-button {
            background-color: #15c11e;
            cursor: pointer; 
            font-size: 12px;
        }
        /* Styles for "Elimina Quesito" button */
        .delete-question-button {
            background-color: #a51b1bc3;
            cursor: pointer;
            font-size: 12px;
            width: 80px;
        }
        .delete-button {
            background-color: #a51b1bc3;
            cursor: pointer; /*modifica il cursore del mouse quando va sopra*/
            font-size: 10px;
            width: 70px;
            padding: 5px;
            margin-left: 25px;
        }

        /* Styles for delete answer button */
        .delete-answer-button {
            background-color: #dc3545;
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        /* Styles for MySQL code textarea */
        .code-textarea {
            width: 100%; /* Make the textarea occupy the full width of its container */
            height: 100px; /* Set the height as needed */
            padding: 10px; /* Add padding for better visual appeal */
            margin-top: 15px; /* Add some spacing above the textarea */
            border: 1px solid #ccc; /* Add a border for clarity */
            border-radius: 5px; /* Add rounded corners for a softer look */
            box-sizing: border-box; /* Include padding and border in the width calculation */
            font-size: 16px; /* Set font size */
            background-color: #f9f9f9; /* Add a light background color */
            color: #333; /* Set text color */
        }
        /* Styles for inizial checkbox */
        input[type="checkbox"] {
            border-radius: 25%;
            transform: scale(1.5); 
        }

        .table-container {
            display: inline-block;
            flex-wrap: nowrap;
            margin-top: 20px;
            font-size: small;
            justify-content: center;
        }
        table {
            display: inline-table; /* Mantiene le tabelle in linea */
            border-collapse: collapse; /* Per una migliore visualizzazione delle tabelle */
        }

        th, td {
            border: 1px solid #ddd; /* Stile dei bordi */
            padding: 5px; /* Padding delle celle */
        }

        th {
            background-color: #f2f2f2; /* Colore di sfondo delle celle dell'intestazione */
        }
        

    </style>
</head>

<body>
    <header>
        <h1>Studia con ESQL</h1>
    </header>
    <div class="main-container">
        <p style="margin-right: 10px; font-size: 28px; font-weight: bold;">Crea Test</p>
        <label for="title" style="font-size: 22px; font-weight: bolder;">Titolo Test:</label>
        <input type="text" id="title" name="title"><br>
        <!--il permesso di visualizzazione deve essere fuori da qui. (anche) quando vedo l'elenco dei test gia creati-->
        <!--<p style="font-size: 18px; font-weight: bold; color: #484141b8;"> Permesso visualizzione risposte
            <input type="checkbox" class="styled-checkbox">
            <span class="checkmark"></span>
        </p> -->
        
        <button onclick="addMenu()">Seleziona Tabelle Necessarie</button>
        <div id="menuContainer">
            <!-- Div per il menu a tendina, inizialmente vuoto -->
        </div>
        
        <br>
        <button onclick="addConstraints()">Aggiungi Vincoli integrit√†</button>
        <div id="constraintsContainer">
            <!-- Qui verranno aggiunti i menu a tendina -->
        </div>
        <div style="display: flex; align-items: center;"></div>
            <button  onclick="addCodeQuestion()">Aggiungi Quesito Codice</button>
            <button  onclick="addMCQuestion()">Aggiungi Quesito Risposta Multipla</button>
        </div>
        <div id="questionsContainer">
            <div id="questions-mc" class="question-mc">   </div>
            <div id="questions-code" class="question-code" >    </div>
        </div>

        <button id="submitTestButton">Crea Test</button>
    </div>
    

    <!-- Includi jQuery per semplificare la gestione delle richieste AJAX -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        // Variabile per memorizzare il nome della tabella selezionata
        var selectedTable = "";
        var tables = []; // Array per tenere traccia delle scelte
    
        // Definisci la funzione JavaScript che viene chiamata quando il bottone viene premuto
        function addMenu() {
            // Effettua una richiesta AJAX per ottenere i nomi delle tabelle dal file PHP
            $.getJSON("../controllers/test/TestController.php", function(data) {
                // Crea il menu a tendina con lo stesso stile di addConstraints
                var select = $("<select class='dropdown-table' name='tabelle'></select>"); // Usa 'dropdown-table' per il primo menu
                // Aggiungi un'opzione di placeholder disabilitata e selezionata di default
                select.append("<option value='' disabled selected>Sel.Tabella</option>");
                // Itera attraverso l'array ricevuto e aggiungi le opzioni al menu a tendina
                $.each(data, function(index, value) {
                    select.append("<option value='" + value.id + "'>" + value.name + "</option>");
                });

                // Inserisci il menu a tendina nel contenitore
                $("#menuContainer").append(select);

                // Aggiungi un gestore per l'evento di cambio al menu a tendina
                select.change(function() {
                    // Nasconde il menu a tendina dopo la selezione
                    $(this).hide();
                    // Esegue le azioni necessarie in base alla selezione
                    var selectedTable = {
                        id: $(this).val(),
                        name: $(this).find("option:selected").text()
                    };
                    tables.push(selectedTable); // Memorizza le tabelle selezionate
                    updateMenuTable1();
                    console.log("Tabella selezionata: ", selectedTable);
                    requestData(selectedTable); // Invia i dati della tabella selezionata
                    // Crea e aggiungi il bottone di eliminazione per questa specifica tabella selezionata
                    //deleteTable(selectedTable.id);

                });
            }).fail(function(jqxhr, textStatus, error) {
                var err = textStatus + ", " + error;
                console.log("Request Failed: " + err);
            });
        }
        function deleteTable(tableId) {
            const deleteButton = $("<button class='delete-button'>Elimina Tabella</button>");
            deleteButton.click(function() {
                // Rimuovi la tabella dall'array tables
                tables = tables.filter(table => table.id !== tableId);
                // Aggiorna il menu a tendina delle tabelle
                updateMenuTable1();

                // Rimuovi la rappresentazione visiva della tabella dal DOM
                $("#table-" + tableId).remove(); // Usa l'ID univoco per rimuovere la tabella
                $(this).remove(); // Assumendo che il bottone sia all'interno di un contenitore parent
                
            });

            // Qui dovresti aggiungere il bottone al DOM, ad esempio appenderlo
            // al contenitore della tabella selezionata o in un altro posto appropriato
            // Ad esempio, se mostri le tabelle selezionate in #selectedTablesContainer:
            $("#menuContainer").append(deleteButton);
        }


        // Funzione per inviare la variabile selectedTable al file PHP
        function requestData(selectedTable) {
            // AJAX request to send data to the PHP file and receive table data
            $.post("ConnessioneProvaAle/SimulatoreInvioDati.php", selectedTable, function(response) {
                console.log("Data received from the server: ", response);
                // Crea un contenitore per la tabella e il bottone di eliminazione
                var tableContainer = $("<div class='table-container'></div>").attr("id", "container-" + selectedTable.id);
        
                // Crea il bottone di eliminazione
                var deleteButton = $("<button class='delete-button'>Elimina Tabella</button>");
                deleteButton.click(function() {
                    // Rimuovi la tabella e il bottone dall'array tables e dal DOM
                    tables = tables.filter(table => table.id !== selectedTable.id);
                    tableContainer.remove(); // Rimuovi il contenitore che include la tabella e il bottone
                    updateMenuTable1();// Aggiorna il menu a tendina delle tabelle
                });
                // Aggiungi il bottone di eliminazione al contenitore della tabella
                tableContainer.append(deleteButton);
                tableContainer.append($("<br>"));
                // Assuming the response is an array of objects, where each object represents a table row
                // Create a table element
                var viewTable = $("<table></table>").attr("id", "table-" + selectedTable.id); 
                // Usa l'ID della tabella per creare un ID univoco per l'elemento table
                viewTable.append("<tr><th>ID</th><th>Name</th></tr>"); // Add table header

                // Add rows to the table based on received data
                $.each(response, function(index, row) {
                    viewTable.append("<tr><td>" + row.id + "</td><td>" + row.name + "</td></tr>");
                });

                // Clear previous table container and add the new table
                    tableContainer.append(viewTable);
                    $("#menuContainer").append(tableContainer);
                // Expecting response in JSON format
            }, "json").fail(function(jqxhr, textStatus, error) {
                var err = textStatus + ", " + error;
                console.log("Request Failed: " + err);
            });
        }
    

        /*function addConstraints() {
            const container = document.getElementById('constraintsContainer');
            const dropdownsDiv = document.createElement('div');
            dropdownsDiv.classList.add('flex-container');

            // Genera un identificativo unico per questo gruppo di dropdown
            const uniqueId = 'group-' + document.querySelectorAll('.flex-container').length;

            // Crea un elemento per la freccia (inizialmente nascosto)
            const arrow = document.createElement('span');
            arrow.id = uniqueId + '-arrow';
            //arrow.innerHTML = '&#x2192;'; // Codice HTML per una freccia verso destra
            arrow.style.display = 'none'; // Nasconde inizialmente la freccia
            arrow.classList.add('separator'); // Aggiungi classi per lo stile se necessario

            // Crea i 4 menu a tendina
            for (let i = 1; i <= 4; i++) {
                const select = document.createElement('select');
                select.id = uniqueId + '-menu' + i; // Assegna un ID unico
                select.classList.add(i === 1 ? 'dropdown-menu1' : 'dropdown-menu');
                if (i !== 4) {
                    select.style.display = i === 1 ? 'block' : 'none'; // Mostra solo il primo menu a tendina
                }
                select.innerHTML = `
                    <option value="">Seleziona opzione</option>
                    <option value="menu${i}.opz1">Menu ${i}.Opzione 1</option>
                    <option value="menu${i}.opz2">Menu ${i}.Opzione 2</option>
                `;
                if (i === 1) {
                    select.onchange = function() { 
                        showDropdown(uniqueId + '-menu1', [uniqueId + '-menu2']); 
                        showDropdown(uniqueId + '-menu2', [uniqueId + '-menu3']); 
                        document.getElementById(uniqueId + '-arrow').style.display = 'inline-block'; // Mostra la freccia
                    };
                }  else if (i === 3) {
                    select.onchange = function() { showDropdown(uniqueId + '-menu3', [uniqueId + '-menu4']); };
                }

                dropdownsDiv.appendChild(select);
                if (i === 2) { // Posiziona la freccia tra il secondo e il terzo menu a tendina
                    dropdownsDiv.appendChild(arrow);
                }
            }

            // Applica la logica per mostrare/nascondere i dropdown basati sulla selezione
            function showDropdown(currentDropdownId, nextDropdownIds) {
                nextDropdownIds.forEach(id => {
                    const dropdown = document.getElementById(id);
                    if (dropdown) dropdown.style.display = 'block';
                });
            }

            container.appendChild(dropdownsDiv);
        }*/
        function addConstraints() {
        const container = document.getElementById('constraintsContainer');
        const dropdownsDiv = document.createElement('div');
        dropdownsDiv.classList.add('flex-container');

        // Genera un identificativo unico per questo gruppo di dropdown
        const uniqueId = 'group-' + document.querySelectorAll('.flex-container').length;
        dropdownsDiv.id = uniqueId; // Assegna un ID univoco al container dei dropdown

        let optionsForMenuTable1 = tables.map(table => `<option value="${table.id}">${table.name}</option>`).join('');

        const menuTable1 = document.createElement('select');
        menuTable1.id = uniqueId + '-menuTable1';
        menuTable1.classList.add('dropdown-table');
        menuTable1.innerHTML = `<option value="" disabled selected>Sel.Tabella</option>` + optionsForMenuTable1;
        dropdownsDiv.appendChild(menuTable1);

        // Crea gli altri menu a tendina
        const menuAttribute1 = document.createElement('select');
        menuAttribute1.id = uniqueId + '-menuAttribute1';
        menuAttribute1.classList.add('dropdown-attribute');
        dropdownsDiv.appendChild(menuAttribute1); // Aggiunto al DOM qui

        const arrow = document.createElement('span');
        arrow.id = uniqueId + '-arrow';
        arrow.style.display = 'none';
        arrow.classList.add('separator');
        dropdownsDiv.appendChild(arrow);     // Assicurati che la freccia sia aggiunta al container

        const menuTable2 = document.createElement('select');
        menuTable2.id = uniqueId + '-menuTable2';
        menuTable2.classList.add('dropdown-table');
        dropdownsDiv.appendChild(menuTable2); // Aggiunto al DOM qui

        const menuAttribute2 = document.createElement('select');
        menuAttribute2.id = uniqueId + '-menuAttribute2';
        menuAttribute2.classList.add('dropdown-attribute');
        dropdownsDiv.appendChild(menuAttribute2); // Aggiunto al DOM qui

        // Gestore dell'evento onchange per menu1
        menuTable1.onchange = function() {
            const selectedTableId = this.value;
            const otherTablesOptions = tables
                .filter(table => table.id !== selectedTableId)
                .map(table => `<option value="${table.id}">${table.name}</option>`)
                .join('');

            $.post("ConnessioneProvaAle/SimulatoreInvioDatiColonne.php", { action: 'getColumns', tableId: selectedTableId }, function(columns) {
                menuAttribute1.innerHTML = `<option value="" disabled selected>Seleziona Attributo</option>` + columns.map(col => `<option value="${col}">${col}</option>`).join('');
                menuAttribute1.style.display = 'block';
                arrow.style.display = 'inline-block';
            }, "json");

            menuTable2.innerHTML = `<option value="" disabled selected>Sel.Tabella</option>` + otherTablesOptions;
            menuTable2.style.display = 'block';
        };

        // Ora, poich√© menuTable2 √® gi√† parte del DOM, puoi aggiungere il gestore dell'evento onchange direttamente
        menuTable2.onchange = function() {
            const selectedTableId = this.value;

            $.post("ConnessioneProvaAle/SimulatoreInvioDatiColonne.php", { action: 'getColumns', tableId: selectedTableId }, function(columns) {
                menuAttribute2.innerHTML = `<option value="" disabled selected>Seleziona Attributo</option>` + columns.map(col => `<option value="${col}">${col}</option>`).join('');
                menuAttribute2.style.display = 'block';
            }, "json");
        };
        // Aggiunta del bottone di eliminazione al DIV contenitore dei dropdown
        deleteConstraint(uniqueId, dropdownsDiv, container);
        // Infine, aggiungi il div dei menu a tendina al container
        container.appendChild(dropdownsDiv);
    }
    function updateMenuTable1() {
        // Trova il container del menu 1 e lo svuota
        const menuTable1 = document.getElementById('group-0-menuTable1');
        if (!menuTable1) return; // Se il menu 1 non esiste, esce dalla funzione
        menuTable1.innerHTML = "<option value='' disabled selected>Sel.Tabella</option>"; // Reset

        // Popola di nuovo il menu con le tabelle aggiornate
        tables.forEach(table => {
            const option = document.createElement('option');
            option.value = table.id;
            option.textContent = table.name;
            menuTable1.appendChild(option);
        });
    }
    function deleteConstraint(uniqueId, dropdownsDiv, container) {
        const deleteButton = document.createElement('button');
        deleteButton.textContent = 'Elimina Vincolo';
        deleteButton.className = 'delete-button';
        deleteButton.onclick = function() {
            // Rimuovi la riga/menu dal DOM
            container.removeChild(dropdownsDiv);
            // Assumi che ogni vincolo corrisponda a una tabella e voglia rimuovere quella tabella dall'array tables
            // Questo passaggio richiede che tu abbia una corrispondenza tra l'ID del gruppo di vincoli e l'ID della tabella
            // Qui manca la logica per identificare la tabella corrispondente, quindi adattalo alle tue esigenze
            // tables = tables.filter(t => t.id !== someId);
            updateMenuTable1(); // Aggiorna il menu delle tabelle dopo la rimozione
        };

        dropdownsDiv.appendChild(deleteButton); // Aggiunge il bottone di eliminazione al div dei dropdown
    }


    </script>

    <script>
        let questionMCCount = 0;
        let questionCodeCount = 0;
        function addMCQuestion() {
            questionMCCount++;

            const container = document.getElementById('questions-mc');

            const questionDiv = document.createElement('div');
            questionDiv.classList.add('question');

            const questionLabel = document.createElement('label');
            //questionLabel.textContent = 'D.' + questionMCCount + ': ';
            questionDiv.appendChild(questionLabel);

            const questionInput = document.createElement('input');
            questionInput.type = 'text';
            questionInput.name = 'question' + questionMCCount;
            questionInput.placeholder = 'Scrivi la Domanda';
            questionInput.classList.add('question-input');
            questionDiv.appendChild(questionInput);

            const deleteQuestionButton = document.createElement('button');
            deleteQuestionButton.textContent = 'Elimina Quesito';
            deleteQuestionButton.classList.add('delete-question-button');
            deleteQuestionButton.onclick = function() {
                container.removeChild(questionDiv);
            };
            questionDiv.appendChild(deleteQuestionButton);
            
            const answersContainer = document.createElement('div');
            answersContainer.classList.add('answers-container');
            questionDiv.appendChild(answersContainer);

            const addAnswerButton = document.createElement('button');
            addAnswerButton.textContent = 'Aggiungi Risposta';
            addAnswerButton.classList.add('add-answer-button');
            addAnswerButton.onclick = function() {
                addAnswer(answersContainer);
            };
            questionDiv.appendChild(addAnswerButton);

            container.appendChild(questionDiv);
        }

        function addAnswer(container) {
            const answerDiv = document.createElement('div');
            answerDiv.classList.add('answer');

            const answerInput = document.createElement('input');
            answerInput.type = 'text';
            answerInput.name = 'answer' + questionMCCount + '_' + (container.children.length + 1);
            answerInput.placeholder = 'Inserisci Risposta';
            answerInput.classList.add('answer-input');
            answerDiv.appendChild(answerInput);

            const correctCheckbox = document.createElement('input');
            correctCheckbox.type = 'checkbox';
            correctCheckbox.name = 'correct' + questionMCCount + '_' + (container.children.length + 1);
            correctCheckbox.classList.add('correct-checkbox');
            answerDiv.appendChild(correctCheckbox);

            const deleteAnswerButton = document.createElement('button');
            deleteAnswerButton.textContent = 'Elimina';
            deleteAnswerButton.classList.add('delete-answer-button');
            deleteAnswerButton.onclick = function() {
                container.removeChild(answerDiv);
            };
            answerDiv.appendChild(deleteAnswerButton);

            container.appendChild(answerDiv);
        }

        function addCodeQuestion() {
            questionCodeCount++;

            const container = document.getElementById('questions-code');

            const questionDiv = document.createElement('div');
            questionDiv.classList.add('question');

            const questionLabel = document.createElement('label');
            //questionLabel.textContent = 'D.' + questionCodeCount + ' Code: ';
            questionDiv.appendChild(questionLabel);

            const questionInput = document.createElement('input');
            questionInput.type = 'text';
            questionInput.name = 'question' + questionCodeCount;
            questionInput.placeholder = 'Scrivi la Domanda';
            questionInput.classList.add('question-input');
            questionDiv.appendChild(questionInput);

            const deleteQuestionButton = document.createElement('button');
            deleteQuestionButton.textContent = 'Elimina Quesito';
            deleteQuestionButton.classList.add('delete-question-button');
            deleteQuestionButton.onclick = function() {
                container.removeChild(questionDiv);
            };
            questionDiv.appendChild(deleteQuestionButton);
            
            
            /*const addCodeAnswerButton = document.createElement('button');
            addCodeAnswerButton.textContent = 'Aggiungi altra risposta MySQL';
            addCodeAnswerButton.classList.add('add-answer-button');
            addCodeAnswerButton.onclick = function() {
                addCodeAnswer(questionDiv);
            };
            questionDiv.appendChild(addCodeAnswerButton);*/

           // Adding MySQL code textarea
            const codeTextarea = document.createElement('textarea');
            codeTextarea.name = 'code' + questionCodeCount;
            codeTextarea.placeholder = 'Inserisci codice MySQL';
            codeTextarea.classList.add('code-textarea');
            questionDiv.appendChild(codeTextarea);
            
            const addCodeAnswerButton = document.createElement('button');
            addCodeAnswerButton.textContent = 'Verifica Codice';
            addCodeAnswerButton.classList.add('add-check-button');
            addCodeAnswerButton.onclick = function() {
                codeCheck();
            };
            questionDiv.appendChild(addCodeAnswerButton);

            container.appendChild(questionDiv);
        }
        function codeCheck() {
            // Ottenere il codice MySQL inserito dall'utente
            const code = document.querySelector('.code-textarea').value;

            // Effettuare una chiamata AJAX per inviare il codice al server
            const xhr = new XMLHttpRequest();
            xhr.open('POST', '../controllers/test/TestController.php', true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function() {
                if (xhr.status === 200) {
                    // Analizzare la risposta
                    const response = JSON.parse(xhr.responseText);
                    if (response.length > 0) {
                        const table = createTable(response); //
                        document.body.appendChild(table);
                        // Il codice √® valido
                        alert('Il codice √® valido!');
                    } else {
                        // Il codice non √® valido
                        alert('Il codice non √® valido!');
                    }
                } else {
                    // Gestione degli errori
                    alert('Errore durante la verifica del codice.');
                }
            };
            xhr.onerror = function() {
                // Gestione degli errori di rete
                alert('Errore di rete durante la verifica del codice.');
            };
            // Invia il codice al server come payload JSON
            xhr.send(JSON.stringify({ code: code }));
        }


    
        function pickupData() {
            var sendDataTest = {
                title: $('#title').val(),
                QuestionMC: [], // Questo sar√† riempito con i dati delle domande a risposta multipla
                questionCode: [], // Questo sar√† riempito con le domande sul codice SQL
                tables: tables, // Assumo che 'tables' sia gi√† un array di oggetti come mostrato
                constraints: [] // Questo dovr√† essere riempito con i vincoli definiti
            };
            // Raccogliere domande a risposta multipla
            $('.question-mc').each(function() {
                    var questionText = $(this).find('.question-input').val(); 
                    var answers = [];
                    $(this).find('.answer').each(function() {
                        var answerText = $(this).find('.answer-input').val();
                        var isCorrect = $(this).find('.correct-checkbox').is(':checked');
                        answers.push({text: answerText, isCorrect: isCorrect});
                    });
                    sendDataTest.QuestionMC.push({questionText: questionText, answers: answers});
                });

                // Raccogliere domande di codice
                $('.question-code').each(function() {
                    var questionText = $(this).find('.question-input').val(); 
                    var sqlCode = $(this).find('.code-textarea').val(); 
                    sendDataTest.questionCode.push({questionText: questionText, sqlCode: sqlCode});
                });
                // Raccogliere dati dei vincoli
                $('.flex-container').each(function() {
                    var constraintData = {
                        table1: $(this).find('#menuTable1.dropdown-table').val(), // Assumi di avere menu con classi specifiche o data-attributes
                        attribute1: $(this).find('menuAttribute1.dropdown-table').val(),
                        table2: $(this).find('menuTable2.dropdown-table').val(),
                        attribute2: $(this).find('menuAttribute2.dropdown-table').val()
                    };
                    sendDataTest.constraints.push(constraintData);
                });
            return sendDataTest;
        }

        function submitFormTest() {
            var sendDataTest = pickupData();
        // Invio dei dati al file PHP tramite AJAX
        $.ajax({
            type: 'POST',
            url: 'xxx.php',
            data: JSON.stringify(sendDataTest),
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            success: function(response) {
                console.log("Risposta del server:", response);
                // Gestire la risposta del server qui
            },
            error: function(xhr, status, error) {
                console.error("Errore durante l'invio dei dati:", status, error);
                // Gestire eventuali errori qui
            }
        });
        }
        // Chiama la funzione definita sopra quando il bottone viene cliccato
        $('#submitTestButton').click(function(e) {
            e.preventDefault(); // Previene il comportamento di sottomissione standard del form
            var dataToSend = pickupData();
            // Qui puoi inviare `dataToSend` al tuo server usando AJAX
            console.log(dataToSend); // Stampa i dati raccolti per debug
        });
    </script>
</body>
<footer>
    <p>Alma Mater Studiorum</p>
    <h3>Universit√† di Bologna</h3>
</footer>
</html>
